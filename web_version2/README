智慧排班系統 (Web-based Smart Scheduler)
這是一個基於 Python Flask 和 Google OR-Tools 的智慧醫師排班網頁應用程式。系統旨在將一個複雜的、基於多重規則與優化目標的排班問題，透過現代化的網頁介面進行管理，實現從醫師提交預休到排班人員一鍵生成最佳化班表的無縫流程。

✨ 核心功能
雙角色操作介面:

醫師端: 提供個人化的儀表板，醫師可透過互動式日曆輕鬆點擊或拖曳選取預休日期，並提交申請。

管理員端: 擁有完整的控制台，可即時監控所有醫師的預休提交狀態。

一鍵智慧排班:

整合 Google OR-Tools 的 CP-SAT 求解器，在所有硬性規則（如：休假天數、班別間隔）的限制下，追求多個軟性目標（如：班表分散度、點數公平性）的最佳解。

即時運算日誌與計時器:

點擊排班後，網頁會即時串流後端求解器的運算過程，讓管理者清楚看見每一個可行解的生成與評分。

日誌標題旁附有動態計時器，精確記錄總運算耗時。

視覺化結果呈現:

運算完成後，直接在網頁上生成仿 Excel 樣式的精美班表，不同院區、假日、預休日皆有顏色標記。

提供區域與日期雙重篩選功能，方便管理者從不同維度檢視班表。

提供全螢幕模式，解決大型班表在小螢幕上不易閱讀的問題。

資料持久化與報表匯出:

醫師的預休資料會自動儲存於本地的 data.json 檔案中，即使重啟伺服器資料依然存在。

可一鍵下載與網頁視覺化結果完全一致的 Excel 報表 (.xlsx)，包含醫師月曆、區域班表、點數統計等多個頁籤。

🛠️ 技術架構 (Technology Stack)
後端 (Backend):

框架: Flask

核心引擎: Google OR-Tools (CP-SAT Solver)

資料處理: Pandas

國定假日: Holidays

Excel 處理: Openpyxl

前端 (Frontend):

語言: HTML, CSS, JavaScript (Vanilla JS)

框架: Bootstrap 5.3

即時通訊: Server-Sent Events (SSE)

📂 專案結構
/FlaskScheduler/
|
├── app.py                  # Flask 主應用程式
├── scheduler.py            # 核心排班引擎
├── data.json               # 預休資料儲存檔案 (自動生成)
|
├── templates/              # HTML 樣板
│   ├── admin.html
│   ├── doctor.html
│   └── index.html
|
├── static/                 # 靜態檔案
│   ├── css/
│   │   └── style.css
│   └── js/
│       └── main.js
|
└── output/                 # 存放生成的 Excel 報表 (自動生成)

🚀 安裝與啟動 (Setup and Run)
1. 環境準備
確認您的電腦已安裝 Python 3.6+。

建議建立一個虛擬環境來管理專案套件：

# 建立虛擬環境
python -m venv venv

# 啟用虛擬環境
# Windows
.\venv\Scripts\activate
# macOS / Linux
source venv/bin/activate

2. 安裝依賴套件
將以下內容儲存為 requirements.txt 檔案，並執行指令安裝：

Flask
pandas
ortools
openpyxl
holidays
```bash
pip install -r requirements.txt

3. 啟動應用程式
在專案根目錄下，執行 app.py：

python app.py

伺服器啟動後，您會在終端機看到類似以下的訊息：

 * Running on [http://127.0.0.1:5000](http://127.0.0.1:5000)

4. 開始使用
打開您的網頁瀏覽器，輸入網址 http://127.0.0.1:5000 即可看到系統首頁。

📖 使用指南
醫師操作流程
在首頁選擇「我是醫師」。

從左上角的下拉選單中選擇您的姓名。

右側會出現當月份的日曆。您可以：

單擊某個日期來選取或取消預休。

按住滑鼠左鍵拖曳過一個日期區間，來一次選取或取消多天預休。

確認無誤後，點擊右下角的「提交本月預休」按鈕。

排班管理員操作流程
在首頁選擇「我是排班管理員」。

左側欄位會顯示當前月份所有醫師的預休提交狀態。您可以切換年份和月份來查看不同時期的狀態。

當列表顯示「所有醫師皆已提交」時，中間的「一鍵排班」按鈕會變為可點擊狀態。

點擊「一鍵排班」，下方的「即時運算日誌」區塊會開始顯示求解過程，並附有計時器。

運算完成後：

日誌區塊會自動收合。

頁面會自動滾動至下方的「最終結果」區塊。

您可以在此透過頁籤切換查看醫師班表、區域班表、結果分析和點數統計。

使用班表上方的篩選器，可以更精準地檢視特定區域或日期的排班狀況。

點擊「全螢幕檢視」可以放大醫師班表。

點擊「下載 Excel」即可獲得一份完整的報表檔案。